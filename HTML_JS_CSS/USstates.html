<!DOCTYPE html>

<!--

Author: Thomas van der Wardt
Student number: 10900578
File: uStates.html
External files: uStates.js, uStates.css, d3.v3.js
Last edited: 2-6-2015

-->
<html>
    <head>
        <title>US States</title>
		<meta charset="UTF-8">
    </head>
<style>

.state-boundary {
  fill: none;
  stroke: #fff;
}

</style>
<body>
<script src="d3.v3.js"></script>
<script src="topojson.v1.min.js"></script>
<script>


	var width = 960,
		height = 500;

	var projection = d3.geo.albersUsa()
		.scale(1000)
		.translate([width / 2, height / 2]);

	var path = d3.geo.path()
		.projection(projection);

	var svg = d3.select("body").append("svg")
		.attr("width", width)
		.attr("height", height);

	d3.json("us.json", function(error, us) {
	  svg.insert("path", ".graticule")
		  .datum(topojson.feature(us, us.objects.land))
		  .attr("class", "land")
		  .attr("d", path);

	  svg.insert("path", ".graticule")
		  .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
		  .attr("class", "state-boundary")
		  .attr("d", path);
	});

	// path data
	d3.json("us.json", function(unitedState) {
		var data = topojson.feature(unitedState, unitedState.objects.states).features;
		
		// our names
		d3.csv("us-state-names.csv", function(csv){
			// extract just the names and Ids
			var nameCodes = {};
			csv.forEach(function(d,i){
				nameCodes[d.id] = d.code;
			});
			
			svg.append("g")
			.attr("class", "states-bundle")
			.selectAll("path")
			.data(data)
			.enter()
			.append("path")
			.attr("d", path)
			.attr("stroke", "white")
			.attr("class", function(d,i) { 
				return nameCodes[d.id];
			})
			.attr("fill", function(d,i) {
				return d3.interpolate("black", "green")(parseInt(d.id)/100) 
			});
		});
	});

	d3.select(self.frameElement).style("height", height + "px"); 

</script>
</body>
</html>